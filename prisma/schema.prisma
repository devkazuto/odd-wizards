generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model mst_users {
  user_address           String  @id
  user_discord_url       String?
  user_twitter_url       String?
  user_image_url         String?
  user_created_date      DateTime?  
  user_total_points      Int?
  user_image_preview     String?
  // Relasi dengan Staker
  mst_staker mst_staker[]
}

model mst_collection {
  collection_id          Int     @id @default(autoincrement())
  collection_address     String?
  collection_name        String?
  collection_description String?
  collection_supply      Int?
  
  // Relasi dengan Staker
  mst_staker mst_staker[]
  mst_attributes_reward mst_attributes_reward[]
}

model mst_staker {
  staker_id               Int       @id @default(autoincrement())
  staker_address          String?
  staker_collection_id    Int?
  staker_lastclaim_date   DateTime?
  staker_nft_staked       Int?
  created_date            DateTime? @default(now())
  updated_date            DateTime? @updatedAt
  staker_total_points     Int?
  staker_red_flag         String?
  
  // Relasi dengan Collection dan Point
  collection mst_collection? @relation(fields: [staker_collection_id], references: [collection_id])
  // Relasi dengan User
  user mst_users? @relation(fields: [staker_address], references: [user_address])
  trn_point  trn_point[]
}

model trn_point {
  point_id            Int       @id @default(autoincrement())
  point_amount        Int?
  point_claim_date    DateTime?
  point_nft_staked    Int?
  point_staker_id     Int?
  
  // Relasi dengan Staker
  staker mst_staker? @relation(fields: [point_staker_id], references: [staker_id])
}

model mst_attributes_reward {
  attr_id             Int       @id @default(autoincrement())
  attr_key            String?
  attr_val            String?
  attr_reward         Int?
  attr_periode        String?
  attr_collection_id  Int?
  collection  mst_collection?  @relation(fields: [attr_collection_id], references: [collection_id])
}

model trn_raffle {
  raffle_id           Int       @id @default(autoincrement())
  raffle_start        DateTime?
  raffle_end          DateTime?
  raffle_price        Int?
  raffle_price_type   String?
  raffle_max_ticket   Int?
  raffle_created_by   String?
  raffle_created_date DateTime?
  rewards  mst_raffle_reward[]
  participants trn_participant[]
}

model mst_raffle_reward {
  reward_id           Int       @id @default(autoincrement())
  reward_type         String?
  reward_amount       Int?
  reward_name         String?
  reward_collection   String?
  reward_token_id     Int?
  reward_token_img    String?
  reward_win_address  String?
  reward_inject_win_address String?
  reward_raffle_id    Int?
  raffle  trn_raffle?   @relation(fields: [reward_raffle_id], references: [raffle_id])
}

model trn_participant {
  participant_id      Int     @id @default(autoincrement())
  participant_address String?
  participant_amount  Int?
  participant_raffle_id Int?
  participant_created_date DateTime?
  raffle  trn_raffle?   @relation(fields: [participant_raffle_id], references: [raffle_id])
}